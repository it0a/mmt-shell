#!/bin/bash
get_db_pass() {
    stty -echo
    printf "Password for ${COLOR_WHITE}$BCMT_USER${COLOR_LIGHTGREEN}@${COLOR_LIGHTGRAY}$BCMT_HOST${COLOR_NONE}: "
    read DBPASS
    stty echo
}
attempt_connection() {
    echo ""
    echo "Connecting to $BCMT_HOST:$BCMT_PORT/$BCMT_DBNAME..."
    echo -en "\033[1A\033[1;35mConnected\033[1B\033[6D${COLOR_NONE}"
    BCMT_DBINITOK=false
    timeout 5s mysql -h $BCMT_HOST -P $BCMT_PORT -u $BCMT_USER -p$DBPASS $BCMT_DBNAME -e exit 2>/dev/null 
    CONNRESULT=$?
    if [ $CONNRESULT = "0" ]
    then
        printf " OK\n"
    else
        printf " FAIL\n"
        die "Unable to connect to database"
    fi
}
do_dbinit() {
    get_db_pass
    attempt_connection
}
