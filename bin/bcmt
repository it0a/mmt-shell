#!/bin/bash
pushd `dirname $0` > /dev/null
SCRIPTPATH=`pwd -P`
popd > /dev/null
. $SCRIPTPATH/includes/init
. $SCRIPTPATH/includes/dbinit
. $SCRIPTPATH/includes/dumpMeta
. $SCRIPTPATH/includes/restMeta
. $SCRIPTPATH/includes/readConf
do_init $1
if [ $BCMT_INITOK = "0" ]
then
    do_dbinit
    if [ $BCMT_DBINITOK = "0" ]
    then
        read_tables
        if [ $BCMT_OPTION = "dump" ]
        then
            for table in "${BCMT_TABLES[@]}"; do dump_table $table; done
        elif [ $BCMT_OPTION = "restore" ]
        then
            for table in ${BCMT_TABLES[@]}; do restore_table $table; done
        else
            echo "This should never happen!"
        fi
    else
        printf "\nCouldn't connect...\n"
    fi
else
    echo "Available commands:"
    echo "dump"
    echo "restore"
fi
